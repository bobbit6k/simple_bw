{% set show_toc = true %}
{% if section %}
    {% if section.extra.toc is defined and section.extra.toc == false %}
        {% set show_toc = false %}
    {% endif %}
{% else %}
    {% if page.extra.toc is defined and page.extra.toc == false %}
        {% set show_toc = false %}
    {% endif %}
{% endif %}

{% if show_toc %}
    <details id="toc">
        <summary>{{ config.extra.toc_intro }}</summary>
        {% if section %}
            {% if section.toc %}
                <ol>
                    {% for h1 in section.toc %}
                        <li>
                            <a href="#{{ h1.id }}">{{ h1.title }}</a>
                            {% if h1.children %}
                                <ol>
                                    {% for h2 in h1.children %}
                                        <li>
                                            <a href="#{{ h2.id }}">{{ h2.title }}</a>
                                        </li>
                                    {% endfor %}
                                </ol>
                            {% endif %}
                        </li>
                    {% endfor %}
                </ol>
            {% endif %}
        {% else %}
            {% if page.toc %}
                <ol>
                    {% for h1 in page.toc %}
                        <li>
                            <a href="#{{ h1.id }}">{{ h1.title }}</a>
                            {% if h1.children %}
                                <ol>
                                    {% for h2 in h1.children %}
                                        <li>
                                            <a href="#{{ h2.id }}">{{ h2.title }}</a>
                                        </li>
                                    {% endfor %}
                                </ol>
                            {% endif %}
                        </li>
                    {% endfor %}
                </ol>
            {% endif %}
        {% endif %}
    </details>
{% endif %}